/*
** vertex.c for wireframe in /home/benito/delivery/wireframe/bonus
** 
** Made by Benoit Lormeau
** Login   <benoit.lormeau@epitech.net>
** 
** Started on  Sat Dec  3 21:26:39 2  016 Benoit Lormeau
** Last update Sat Dec  3 21:26:41 2  016 Benoit Lormeau
*/

#include "buffer.h"
#include "my_sfml.h"

sfColor	get_colorFromHeight(float z)
{
  int	f;
  int	tab[255][3] = {
    {  0,  0,160}, {  0,  0,160}, {  0,  0,160}, {  0,  0,160}, {  0, 10,160}, {  0, 15,160}, {  0, 20,160}, {  0, 25,150}, {  0, 30,140}, {  0, 35,130},
    {  0, 40,120}, {  0, 45,110}, {  0, 50,100}, {  0, 55, 90}, {  0, 60, 80}, {  0, 65, 70}, {  0, 70, 60}, {  0, 75, 50}, {  0, 80, 40}, {  0, 85, 30},
    {  0, 90, 20}, {  0, 95, 10}, {  0,100,  0}, {  0,105,  0}, {  0,110,  0}, {  0,115,  0}, {  0,120,  0}, {  0,125,  0}, {  0,130,  0}, {  0,130,  0},
    {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0},
    {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0},
    {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0}, {  0,130,  0},
    {  5,125,  0}, { 10,120,  0}, { 15,115,  0}, { 20,110,  0}, { 25,105,  0}, { 30,100,  0}, { 35, 95,  0}, { 40, 90,  0}, { 45, 85,  0}, { 50, 80,  0},
    { 55, 75,  0}, { 60, 70,  0}, { 65, 65,  0}, { 70, 60,  0}, { 75, 55,  0}, { 80, 50,  0}, { 85, 45,  0}, { 90, 40,  0}, { 95, 40,  0}, {100, 40,  0},
    {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0},
    {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0}, {100, 40,  0},
    { 95, 40,  0}, { 95, 40,  0}, { 95, 40,  0}, { 95, 40,  0}, { 95, 40,  0}, { 95, 40,  0}, { 95, 40,  0}, { 95, 40,  0}, { 95, 40,  0}, { 95, 40,  0},
    { 90, 40,  0}, { 90, 40,  0}, { 90, 40,  0}, { 90, 40,  0}, { 90, 40,  0}, { 90, 40,  0}, { 90, 40,  0}, { 90, 40,  0}, { 90, 40,  0}, { 90, 40,  0},
    { 85, 40,  0}, { 85, 40,  0}, { 85, 40,  0}, { 85, 40,  0}, { 85, 40,  0}, { 85, 40,  0}, { 85, 40,  0}, { 85, 40,  0}, { 85, 40,  0}, { 85, 40,  0},
    { 80, 40,  0}, { 80, 40,  0}, { 80, 40,  0}, { 80, 40,  0}, { 80, 40,  0}, { 80, 40,  0}, { 80, 40,  0}, { 80, 40,  0}, { 80, 40,  0}, { 80, 40,  0},
    { 75, 40,  0}, { 75, 40,  0}, { 75, 40,  0}, { 75, 40,  0}, { 75, 40,  0}, { 75, 40,  0}, { 75, 40,  0}, { 75, 40,  0}, { 75, 40,  0}, { 75, 40,  0},
    { 70, 40,  0}, { 70, 40,  0}, { 70, 40,  0}, { 70, 40,  0}, { 70, 40,  0}, { 70, 40,  0}, { 70, 40,  0}, { 70, 40,  0}, { 70, 40,  0}, { 70, 40,  0},
    { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0},
    { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0},
    { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0},
    { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0},
    { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0},
    { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0},
    { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0},
    { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0},
    { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}, { 65, 40,  0}
  };

  f = my_map(z, 0, 10, 0, 250);
  return (sfColor_fromRGB(tab[f][0], tab[f][1], tab[f][2]));
}

sfVertexArray	*get_vertexArray(sfVertexArray *vertices, char *path)
{
  t_map		map;

  map = parse_buffer(path);

  for (int i =  0; i < MAP_H * MAP_W; ++i){
    map.tab[i].x -= MAP_W / 2;
    map.tab[i].y -= MAP_H / 2;

    sfVertexArray_append(vertices,
      (sfVertex){
    	my_orthogonal_projection(map.tab[i], omega_, alpha_),
	get_colorFromHeight(map.tab[i].z),
	(sfVector2f){0, 0}
      }
    );
  }

  return (vertices);
}

sfVertexArray	*get_vertexArray_line(sfVertexArray *vertices, unsigned int start)
{
  sfVertexArray	*line;

  line = sfVertexArray_create();

  for (int i = 0; i < MAP_H; ++i){
    sfVertexArray_append(line, *sfVertexArray_getVertex(vertices, start + i));
    sfVertexArray_append(line, *sfVertexArray_getVertex(vertices, start + i + MAP_W));
  }

  return (line);
}